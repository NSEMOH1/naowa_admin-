import{r as o,j as t,T as m,e as w}from"./index-CRMG5bzS.js";import{D as j}from"./index-D2SIzbjx.js";import{e as k}from"./excelExport-BIpDu_Yb.js";import{H as c}from"./text-DC-W0PyF.js";import{B as v}from"./use-form-control-CQKzOfDr.js";import{I as p}from"./input-BfnAPdur.js";import{B as h}from"./badge-DiIJR_EX.js";import"./fade-BWbPEriw.js";import"./select-C_HCPDtk.js";import"./key-BWXZw050.js";import"./xlsx-3SA47z_C.js";import"./children-aMr2zYAb.js";const P=()=>{const[i,x]=o.useState([]),[f,y]=o.useState(!0),[u,N]=o.useState(""),[r,D]=o.useState(""),[s,b]=o.useState("");o.useEffect(()=>{(async()=>{try{const n=await w.get("/api/admin-report/interests");x(n.data)}catch(n){N(n.response?.data?.message||"Failed to fetch interests data")}finally{y(!1)}})()},[]);const d=o.useMemo(()=>!r&&!s?i:i.filter(e=>{const n=new Date(e.date||e.createdAt),l=r?new Date(r):null,a=s?new Date(s):null;return!(l&&n<l||a&&n>a)}),[i,r,s]),g=[{title:"Full Name",dataIndex:"fullName",key:"fullName"},{title:"Service Number",dataIndex:"serviceNumber",key:"serviceNumber"},{title:"Account Number",dataIndex:"accountNo",key:"accountNo"},{title:"Amount",dataIndex:"amount",key:"amount",render:e=>t.jsx(h,{colorScheme:"yellow",children:e})},{title:"Type",dataIndex:"type",key:"type"},{title:"Date",dataIndex:"date",key:"date",render:e=>e?new Date(e).toLocaleDateString():"-"},{title:"Status",dataIndex:"status",key:"status",render:e=>t.jsx(h,{colorScheme:e==="COMPLETED"?"green":"orange",children:e})}],S=()=>{window.print()};return u?t.jsx("div",{className:"text-red-500",children:u}):t.jsxs("div",{className:"mt-7",children:[t.jsx("p",{className:"text-3xl font-bold mb-6",children:"Interests"}),t.jsxs("div",{className:"flex justify-between",children:[t.jsxs(c,{spacing:4,children:[t.jsxs("button",{style:{background:"green",color:"white",padding:"8px 16px",borderRadius:"5px",border:"none",cursor:"pointer"},onClick:()=>{try{const e=d.map(a=>({"Full Name":a.fullName,"Service Number":a.serviceNumber,"Account Number":a.accountNo,Amount:a.amount,Type:a.type,Date:a.date?new Date(a.date).toLocaleDateString():"-",Status:a.status}));if(e.length===0){m({title:"No data found",status:"warning"});return}const n=[{key:"Full Name",header:"Full Name",width:20},{key:"Service Number",header:"Service Number",width:18},{key:"Account Number",header:"Account Number",width:18},{key:"Amount",header:"Amount",width:15,type:"currency"},{key:"Type",header:"Type",width:15},{key:"Date",header:"Date",width:15},{key:"Status",header:"Status",width:15}],l=r&&s?`_${r}_to_${s}`:r?`_from_${r}`:s?`_to_${s}`:"";k({data:e,columns:n,filename:`interests${l}_${new Date().toISOString().slice(0,10)}.xlsx`,sheetName:"Interests",title:`Interest Report${l?` (${l.replace(/_/g," ")})`:""}`}),console.log(`Successfully exported ${e.length} interest records`)}catch{m({title:"Export failed",status:"error"})}},children:["Export (",d.length,")"]}),t.jsx(v,{onClick:S,colorScheme:"teal",size:"sm",children:"Print Report"})]}),t.jsxs(c,{spacing:4,mb:4,children:[t.jsxs(c,{children:[t.jsx("label",{htmlFor:"startDate",className:"block text-xs font-medium mb-1",children:"From"}),t.jsx(p,{size:"sm",type:"date",id:"startDate",value:r,onChange:e=>D(e.target.value),max:s||void 0})]}),t.jsxs(c,{children:[t.jsx("label",{htmlFor:"endDate",className:"block text-xs font-medium mb-1",children:"To"}),t.jsx(p,{size:"sm",type:"date",id:"endDate",value:s,onChange:e=>b(e.target.value),min:r||void 0})]})]})]}),t.jsx(j,{data:d,columns:g,loading:f,rowKey:"serviceNumber"})]})};export{P as default};
