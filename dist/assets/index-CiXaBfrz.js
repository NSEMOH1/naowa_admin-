import{r as o,j as t,T as p,e as j}from"./index-CRMG5bzS.js";import{D as k}from"./index-D2SIzbjx.js";import{e as w}from"./excelExport-BIpDu_Yb.js";import{H as c}from"./text-DC-W0PyF.js";import{B as v}from"./use-form-control-CQKzOfDr.js";import{I as h}from"./input-BfnAPdur.js";import{B as d}from"./badge-DiIJR_EX.js";import"./fade-BWbPEriw.js";import"./select-C_HCPDtk.js";import"./key-BWXZw050.js";import"./xlsx-3SA47z_C.js";import"./children-aMr2zYAb.js";const H=()=>{const[u,x]=o.useState([]),[f,y]=o.useState(!0),[m,b]=o.useState(""),[r,D]=o.useState(""),[n,N]=o.useState("");o.useEffect(()=>{(async()=>{try{const s=await j.get("/api/admin-report/financial");x(s.data)}catch(s){b(s.response?.data?.message||"Failed to fetch financial data")}finally{y(!1)}})()},[]);const l=o.useMemo(()=>u.filter(e=>{const s=new Date(e.date),i=r?new Date(r):null,a=n?new Date(n):null;return!(i&&s<i||a&&s>a)}),[u,r,n]),g=[{title:"Full Name",dataIndex:"fullName",key:"fullName"},{title:"Service Number",dataIndex:"serviceNumber",key:"serviceNumber"},{title:"Account Number",dataIndex:"accountNo",key:"accountNo"},{title:"Debit",dataIndex:"debit",key:"debit",render:e=>e!=="-"?t.jsx(d,{colorScheme:"red",children:e}):"-"},{title:"Credit",dataIndex:"credit",key:"credit",render:e=>e!=="-"?t.jsx(d,{colorScheme:"green",children:e}):"-"},{title:"Type",dataIndex:"type",key:"type"},{title:"Date",dataIndex:"date",key:"date",render:e=>new Date(e).toLocaleDateString()},{title:"Status",dataIndex:"status",key:"status",render:e=>e!=="-"?t.jsx(d,{colorScheme:"green",children:e}):"-"}],S=()=>{window.print()};return m?t.jsx("div",{className:"text-red-500",children:m}):t.jsxs("div",{className:"mt-7",children:[t.jsx("p",{className:"text-3xl font-bold mb-6",children:"Financial Reports"}),t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs(c,{spacing:4,children:[t.jsxs("button",{style:{background:"green",color:"white",padding:"8px 16px",borderRadius:"5px",border:"none",cursor:"pointer"},onClick:()=>{try{const e=l.map(a=>({"Full Name":a.fullName,"Service Number":a.serviceNumber,"Account Number":a.accountNo,Debit:a.debit,Credit:a.credit,Type:a.type,Date:new Date(a.date).toLocaleDateString(),Status:a.status}));if(e.length===0){p({title:"No data found",status:"warning"});return}const s=[{key:"Full Name",header:"Full Name",width:20},{key:"Service Number",header:"Service Number",width:18},{key:"Account Number",header:"Account Number",width:18},{key:"Debit",header:"Debit",width:15,type:"currency"},{key:"Credit",header:"Credit",width:15,type:"currency"},{key:"Type",header:"Type",width:15},{key:"Date",header:"Date",width:15},{key:"Status",header:"Status",width:15}],i=r&&n?`_${r}_to_${n}`:r?`_from_${r}`:n?`_to_${n}`:"";w({data:e,columns:s,filename:`financial-report${i}_${new Date().toISOString().slice(0,10)}.xlsx`,sheetName:"Financial Report",title:`Financial Report${i?` (${i.replace(/_/g," ")})`:""}`}),console.log(`Successfully exported ${e.length} financial records`)}catch(e){console.error("Export failed:",e),p({title:"Export failed",status:"error"})}},children:["Export (",l.length,")"]}),t.jsx(v,{onClick:S,colorScheme:"teal",size:"sm",children:"Print Report"})]}),t.jsxs(c,{spacing:4,mb:4,children:[t.jsxs(c,{children:[t.jsx("label",{htmlFor:"startDate",className:"text-xs font-medium mb-1",children:"From"}),t.jsx(h,{size:"sm",type:"date",id:"startDate",value:r,onChange:e=>D(e.target.value),max:n||void 0})]}),t.jsxs(c,{children:[t.jsx("label",{htmlFor:"endDate",className:"block text-xs font-medium mb-1",children:"To"}),t.jsx(h,{size:"sm",type:"date",id:"endDate",value:n,onChange:e=>N(e.target.value),min:r||void 0})]})]})]}),t.jsx(k,{data:l,columns:g,loading:f,rowKey:"serviceNumber"})]})};export{H as default};
