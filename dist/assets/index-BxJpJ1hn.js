import{w as pn,x as Lt,r as p,y as Ye,s as Fe,z as Bt,B as Ge,m as Ft,o as zt,C as mn,j as l,D as hn,l as te,n as je,q as ne,E as vn,F as gn,G as ze,f as $t,u as xn,S as bn,I as yn,J as wn,K as On,M as En,e as gt}from"./index-CRMG5bzS.js";import{u as Ve,w as Cn}from"./xlsx-3SA47z_C.js";import{m as de,B as be}from"./use-form-control-CQKzOfDr.js";import{u as _t,C as jn,a as Sn}from"./circle-x-KiDpDjvU.js";import{i as kn,M as Dn,a as Pn,b as Mn,c as In,d as Tn,e as An}from"./modal-overlay-DqBh97wO.js";import{F as He}from"./file-text-jj6b-FYb.js";import{D as Rn}from"./download-CcwuIIIl.js";import{S as Nn,B as Q,H as re,f as L,g as Ln,T as Bn,a as Fn,b as Re,c as oe,C as xt,d as zn,e as Y}from"./text-DC-W0PyF.js";import{I as bt}from"./input-BfnAPdur.js";import{B as $n}from"./badge-DiIJR_EX.js";import{M as _n}from"./modal-footer-CYNbZFBh.js";import"./fade-BWbPEriw.js";import"./children-aMr2zYAb.js";function Un(e){return Ut(e)?.defaultView??window}function Ut(e){return pn(e)?e.ownerDocument:document}function Wn(e){return Ut(e).activeElement}function Vn(e){const{wasSelected:t,enabled:n,isSelected:r,mode:o="unmount"}=e;return!!(!n||r||o==="keepMounted"&&t)}function Hn(e,t,n,r){const o=Lt(n);return p.useEffect(()=>{const s=typeof e=="function"?e():e??document;if(!(!n||!s))return s.addEventListener(t,o,r),()=>{s.removeEventListener(t,o,r)}},[t,e,r,o,n]),()=>{(typeof e=="function"?e():e??document)?.removeEventListener(t,o,r)}}function Kn(e){const{isOpen:t,ref:n}=e,[r,o]=p.useState(t),[s,c]=p.useState(!1);return p.useEffect(()=>{s||(o(t),c(!0))},[t,s,r]),Hn(()=>n.current,"animationend",()=>{o(t)}),{present:!(t?!1:!r),onComplete(){const a=Un(n.current),d=new a.CustomEvent("animationend",{bubbles:!0});n.current?.dispatchEvent(d)}}}function qn(e){const t=e.current;if(!t)return!1;const n=Wn(t);return!n||t.contains(n)?!1:!!kn(n)}function Xn(e,t){const{visible:n,focusRef:r}=t,o=!n;Ye(()=>{if(!o||qn(e))return;const s=r?.current||e.current;let c;if(s)return c=requestAnimationFrame(()=>{s.focus({preventScroll:!0})}),()=>{cancelAnimationFrame(c)}},[o,e,r])}function Yn(e,t){const n=p.useId();return p.useMemo(()=>e||[t,n].filter(Boolean).join("-"),[e,t,n])}function Gn(e,...t){const n=Yn(e);return p.useMemo(()=>t.map(r=>`${r}-${n}`),[n,t])}function Jn(e){const{ref:t,handler:n,enabled:r=!0}=e,o=Lt(n),c=p.useRef({isPointerDown:!1,ignoreEmulatedMouseEvents:!1}).current;p.useEffect(()=>{if(!r)return;const i=v=>{Ke(v,t)&&(c.isPointerDown=!0)},a=v=>{if(c.ignoreEmulatedMouseEvents){c.ignoreEmulatedMouseEvents=!1;return}c.isPointerDown&&n&&Ke(v,t)&&(c.isPointerDown=!1,o(v))},d=v=>{c.ignoreEmulatedMouseEvents=!0,n&&c.isPointerDown&&Ke(v,t)&&(c.isPointerDown=!1,o(v))},u=Wt(t.current);return u.addEventListener("mousedown",i,!0),u.addEventListener("mouseup",a,!0),u.addEventListener("touchstart",i,!0),u.addEventListener("touchend",d,!0),()=>{u.removeEventListener("mousedown",i,!0),u.removeEventListener("mouseup",a,!0),u.removeEventListener("touchstart",i,!0),u.removeEventListener("touchend",d,!0)}},[n,t,o,c,r])}function Ke(e,t){const n=e.composedPath?.()[0]??e.target;return n&&!Wt(n).contains(n)?!1:!t.current?.contains(n)}function Wt(e){return e?.ownerDocument??document}function yt(e){return e.sort((t,n)=>{const r=t.compareDocumentPosition(n);if(r&Node.DOCUMENT_POSITION_FOLLOWING||r&Node.DOCUMENT_POSITION_CONTAINED_BY)return-1;if(r&Node.DOCUMENT_POSITION_PRECEDING||r&Node.DOCUMENT_POSITION_CONTAINS)return 1;if(r&Node.DOCUMENT_POSITION_DISCONNECTED||r&Node.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC)throw Error("Cannot sort the given nodes.");return 0})}const Zn=e=>typeof e=="object"&&"nodeType"in e&&e.nodeType===Node.ELEMENT_NODE;function wt(e,t,n){let r=e+1;return n&&r>=t&&(r=0),r}function Ot(e,t,n){let r=e-1;return n&&r<0&&(r=t),r}const qe=typeof window<"u"?p.useLayoutEffect:p.useEffect,Et=e=>e;var Qn=Object.defineProperty,er=(e,t,n)=>t in e?Qn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,R=(e,t,n)=>(er(e,typeof t!="symbol"?t+"":t,n),n);class tr{constructor(){R(this,"descendants",new Map),R(this,"register",t=>{if(t!=null)return Zn(t)?this.registerNode(t):n=>{this.registerNode(n,t)}}),R(this,"unregister",t=>{this.descendants.delete(t);const n=yt(Array.from(this.descendants.keys()));this.assignIndex(n)}),R(this,"destroy",()=>{this.descendants.clear()}),R(this,"assignIndex",t=>{this.descendants.forEach(n=>{const r=t.indexOf(n.node);n.index=r,n.node.dataset.index=n.index.toString()})}),R(this,"count",()=>this.descendants.size),R(this,"enabledCount",()=>this.enabledValues().length),R(this,"values",()=>Array.from(this.descendants.values()).sort((n,r)=>n.index-r.index)),R(this,"enabledValues",()=>this.values().filter(t=>!t.disabled)),R(this,"item",t=>{if(this.count()!==0)return this.values()[t]}),R(this,"enabledItem",t=>{if(this.enabledCount()!==0)return this.enabledValues()[t]}),R(this,"first",()=>this.item(0)),R(this,"firstEnabled",()=>this.enabledItem(0)),R(this,"last",()=>this.item(this.descendants.size-1)),R(this,"lastEnabled",()=>{const t=this.enabledValues().length-1;return this.enabledItem(t)}),R(this,"indexOf",t=>t?this.descendants.get(t)?.index??-1:-1),R(this,"enabledIndexOf",t=>t==null?-1:this.enabledValues().findIndex(n=>n.node.isSameNode(t))),R(this,"next",(t,n=!0)=>{const r=wt(t,this.count(),n);return this.item(r)}),R(this,"nextEnabled",(t,n=!0)=>{const r=this.item(t);if(!r)return;const o=this.enabledIndexOf(r.node),s=wt(o,this.enabledCount(),n);return this.enabledItem(s)}),R(this,"prev",(t,n=!0)=>{const r=Ot(t,this.count()-1,n);return this.item(r)}),R(this,"prevEnabled",(t,n=!0)=>{const r=this.item(t);if(!r)return;const o=this.enabledIndexOf(r.node),s=Ot(o,this.enabledCount()-1,n);return this.enabledItem(s)}),R(this,"registerNode",(t,n)=>{if(!t||this.descendants.has(t))return;const r=Array.from(this.descendants.keys()).concat(t),o=yt(r);n?.disabled&&(n.disabled=!!n.disabled);const s={node:t,index:-1,...n};this.descendants.set(t,s),this.assignIndex(o)})}}function nr(){const[e,t]=Fe({name:"DescendantsProvider",errorMessage:"useDescendantsContext must be used within DescendantsProvider"});return[e,t,()=>{const o=p.useRef(new tr);return qe(()=>()=>o.current.destroy()),o.current},o=>{const s=t(),[c,i]=p.useState(-1),a=p.useRef(null);qe(()=>()=>{a.current&&s.unregister(a.current)},[]),qe(()=>{if(!a.current)return;const u=Number(a.current.dataset.index);c!=u&&!Number.isNaN(u)&&i(u)});const d=Et(o?s.register(o):s.register);return{descendants:s,index:c,enabledIndex:s.enabledIndexOf(a.current),register:de(d,a)}}]}function rr(e,t,n,r){if(t==null)return r;if(!r)return e.find(c=>n(c).toLowerCase().startsWith(t.toLowerCase()));const o=e.filter(s=>n(s).toLowerCase().startsWith(t.toLowerCase()));if(o.length>0){let s;return o.includes(r)?(s=o.indexOf(r)+1,s===o.length&&(s=0),o[s]):(s=e.indexOf(o[0]),e[s])}return r}function or(e){const{key:t}=e;return t.length===1||t.length>1&&/[^a-zA-Z0-9]/.test(t)}function sr(e={}){const{timeout:t=300,preventDefault:n=()=>!0}=e,[r,o]=p.useState([]),s=p.useRef(void 0),c=()=>{s.current&&(clearTimeout(s.current),s.current=null)},i=()=>{c(),s.current=setTimeout(()=>{o([]),s.current=null},t)};p.useEffect(()=>c,[]);function a(d){return u=>{if(u.key==="Backspace"){const v=[...r];v.pop(),o(v);return}if(or(u)){const v=r.concat(u.key);n(u)&&(u.preventDefault(),u.stopPropagation()),o(v),d(v.join("")),i()}}}return a}var z="top",K="bottom",q="right",$="left",tt="auto",De=[z,K,q,$],me="start",Se="end",ar="clippingParents",Vt="viewport",ye="popper",ir="reference",Ct=De.reduce(function(e,t){return e.concat([t+"-"+me,t+"-"+Se])},[]),Ht=[].concat(De,[tt]).reduce(function(e,t){return e.concat([t,t+"-"+me,t+"-"+Se])},[]),cr="beforeRead",lr="read",ur="afterRead",dr="beforeMain",fr="main",pr="afterMain",mr="beforeWrite",hr="write",vr="afterWrite",gr=[cr,lr,ur,dr,fr,pr,mr,hr,vr];function J(e){return e?(e.nodeName||"").toLowerCase():null}function W(e){if(e==null)return window;if(e.toString()!=="[object Window]"){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function fe(e){var t=W(e).Element;return e instanceof t||e instanceof Element}function H(e){var t=W(e).HTMLElement;return e instanceof t||e instanceof HTMLElement}function nt(e){if(typeof ShadowRoot>"u")return!1;var t=W(e).ShadowRoot;return e instanceof t||e instanceof ShadowRoot}function xr(e){var t=e.state;Object.keys(t.elements).forEach(function(n){var r=t.styles[n]||{},o=t.attributes[n]||{},s=t.elements[n];!H(s)||!J(s)||(Object.assign(s.style,r),Object.keys(o).forEach(function(c){var i=o[c];i===!1?s.removeAttribute(c):s.setAttribute(c,i===!0?"":i)}))})}function br(e){var t=e.state,n={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,n.popper),t.styles=n,t.elements.arrow&&Object.assign(t.elements.arrow.style,n.arrow),function(){Object.keys(t.elements).forEach(function(r){var o=t.elements[r],s=t.attributes[r]||{},c=Object.keys(t.styles.hasOwnProperty(r)?t.styles[r]:n[r]),i=c.reduce(function(a,d){return a[d]="",a},{});!H(o)||!J(o)||(Object.assign(o.style,i),Object.keys(s).forEach(function(a){o.removeAttribute(a)}))})}}const yr={name:"applyStyles",enabled:!0,phase:"write",fn:xr,effect:br,requires:["computeStyles"]};function G(e){return e.split("-")[0]}var ue=Math.max,Be=Math.min,he=Math.round;function Je(){var e=navigator.userAgentData;return e!=null&&e.brands&&Array.isArray(e.brands)?e.brands.map(function(t){return t.brand+"/"+t.version}).join(" "):navigator.userAgent}function Kt(){return!/^((?!chrome|android).)*safari/i.test(Je())}function ve(e,t,n){t===void 0&&(t=!1),n===void 0&&(n=!1);var r=e.getBoundingClientRect(),o=1,s=1;t&&H(e)&&(o=e.offsetWidth>0&&he(r.width)/e.offsetWidth||1,s=e.offsetHeight>0&&he(r.height)/e.offsetHeight||1);var c=fe(e)?W(e):window,i=c.visualViewport,a=!Kt()&&n,d=(r.left+(a&&i?i.offsetLeft:0))/o,u=(r.top+(a&&i?i.offsetTop:0))/s,v=r.width/o,C=r.height/s;return{width:v,height:C,top:u,right:d+v,bottom:u+C,left:d,x:d,y:u}}function rt(e){var t=ve(e),n=e.offsetWidth,r=e.offsetHeight;return Math.abs(t.width-n)<=1&&(n=t.width),Math.abs(t.height-r)<=1&&(r=t.height),{x:e.offsetLeft,y:e.offsetTop,width:n,height:r}}function qt(e,t){var n=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(n&&nt(n)){var r=t;do{if(r&&e.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function ee(e){return W(e).getComputedStyle(e)}function wr(e){return["table","td","th"].indexOf(J(e))>=0}function se(e){return((fe(e)?e.ownerDocument:e.document)||window.document).documentElement}function $e(e){return J(e)==="html"?e:e.assignedSlot||e.parentNode||(nt(e)?e.host:null)||se(e)}function jt(e){return!H(e)||ee(e).position==="fixed"?null:e.offsetParent}function Or(e){var t=/firefox/i.test(Je()),n=/Trident/i.test(Je());if(n&&H(e)){var r=ee(e);if(r.position==="fixed")return null}var o=$e(e);for(nt(o)&&(o=o.host);H(o)&&["html","body"].indexOf(J(o))<0;){var s=ee(o);if(s.transform!=="none"||s.perspective!=="none"||s.contain==="paint"||["transform","perspective"].indexOf(s.willChange)!==-1||t&&s.willChange==="filter"||t&&s.filter&&s.filter!=="none")return o;o=o.parentNode}return null}function Pe(e){for(var t=W(e),n=jt(e);n&&wr(n)&&ee(n).position==="static";)n=jt(n);return n&&(J(n)==="html"||J(n)==="body"&&ee(n).position==="static")?t:n||Or(e)||t}function ot(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function Ee(e,t,n){return ue(e,Be(t,n))}function Er(e,t,n){var r=Ee(e,t,n);return r>n?n:r}function Xt(){return{top:0,right:0,bottom:0,left:0}}function Yt(e){return Object.assign({},Xt(),e)}function Gt(e,t){return t.reduce(function(n,r){return n[r]=e,n},{})}var Cr=function(t,n){return t=typeof t=="function"?t(Object.assign({},n.rects,{placement:n.placement})):t,Yt(typeof t!="number"?t:Gt(t,De))};function jr(e){var t,n=e.state,r=e.name,o=e.options,s=n.elements.arrow,c=n.modifiersData.popperOffsets,i=G(n.placement),a=ot(i),d=[$,q].indexOf(i)>=0,u=d?"height":"width";if(!(!s||!c)){var v=Cr(o.padding,n),C=rt(s),m=a==="y"?z:$,D=a==="y"?K:q,y=n.rects.reference[u]+n.rects.reference[a]-c[a]-n.rects.popper[u],h=c[a]-n.rects.reference[a],j=Pe(s),g=j?a==="y"?j.clientHeight||0:j.clientWidth||0:0,b=y/2-h/2,w=v[m],E=g-C[u]-v[D],S=g/2-C[u]/2+b,k=Ee(w,S,E),P=a;n.modifiersData[r]=(t={},t[P]=k,t.centerOffset=k-S,t)}}function Sr(e){var t=e.state,n=e.options,r=n.element,o=r===void 0?"[data-popper-arrow]":r;o!=null&&(typeof o=="string"&&(o=t.elements.popper.querySelector(o),!o)||qt(t.elements.popper,o)&&(t.elements.arrow=o))}const kr={name:"arrow",enabled:!0,phase:"main",fn:jr,effect:Sr,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function ge(e){return e.split("-")[1]}var Dr={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Pr(e,t){var n=e.x,r=e.y,o=t.devicePixelRatio||1;return{x:he(n*o)/o||0,y:he(r*o)/o||0}}function St(e){var t,n=e.popper,r=e.popperRect,o=e.placement,s=e.variation,c=e.offsets,i=e.position,a=e.gpuAcceleration,d=e.adaptive,u=e.roundOffsets,v=e.isFixed,C=c.x,m=C===void 0?0:C,D=c.y,y=D===void 0?0:D,h=typeof u=="function"?u({x:m,y}):{x:m,y};m=h.x,y=h.y;var j=c.hasOwnProperty("x"),g=c.hasOwnProperty("y"),b=$,w=z,E=window;if(d){var S=Pe(n),k="clientHeight",P="clientWidth";if(S===W(n)&&(S=se(n),ee(S).position!=="static"&&i==="absolute"&&(k="scrollHeight",P="scrollWidth")),S=S,o===z||(o===$||o===q)&&s===Se){w=K;var M=v&&S===E&&E.visualViewport?E.visualViewport.height:S[k];y-=M-r.height,y*=a?1:-1}if(o===$||(o===z||o===K)&&s===Se){b=q;var f=v&&S===E&&E.visualViewport?E.visualViewport.width:S[P];m-=f-r.width,m*=a?1:-1}}var O=Object.assign({position:i},d&&Dr),T=u===!0?Pr({x:m,y},W(n)):{x:m,y};if(m=T.x,y=T.y,a){var I;return Object.assign({},O,(I={},I[w]=g?"0":"",I[b]=j?"0":"",I.transform=(E.devicePixelRatio||1)<=1?"translate("+m+"px, "+y+"px)":"translate3d("+m+"px, "+y+"px, 0)",I))}return Object.assign({},O,(t={},t[w]=g?y+"px":"",t[b]=j?m+"px":"",t.transform="",t))}function Mr(e){var t=e.state,n=e.options,r=n.gpuAcceleration,o=r===void 0?!0:r,s=n.adaptive,c=s===void 0?!0:s,i=n.roundOffsets,a=i===void 0?!0:i,d={placement:G(t.placement),variation:ge(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:o,isFixed:t.options.strategy==="fixed"};t.modifiersData.popperOffsets!=null&&(t.styles.popper=Object.assign({},t.styles.popper,St(Object.assign({},d,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:c,roundOffsets:a})))),t.modifiersData.arrow!=null&&(t.styles.arrow=Object.assign({},t.styles.arrow,St(Object.assign({},d,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:a})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})}const Ir={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:Mr,data:{}};var Ne={passive:!0};function Tr(e){var t=e.state,n=e.instance,r=e.options,o=r.scroll,s=o===void 0?!0:o,c=r.resize,i=c===void 0?!0:c,a=W(t.elements.popper),d=[].concat(t.scrollParents.reference,t.scrollParents.popper);return s&&d.forEach(function(u){u.addEventListener("scroll",n.update,Ne)}),i&&a.addEventListener("resize",n.update,Ne),function(){s&&d.forEach(function(u){u.removeEventListener("scroll",n.update,Ne)}),i&&a.removeEventListener("resize",n.update,Ne)}}const Ar={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:Tr,data:{}};var Rr={left:"right",right:"left",bottom:"top",top:"bottom"};function Le(e){return e.replace(/left|right|bottom|top/g,function(t){return Rr[t]})}var Nr={start:"end",end:"start"};function kt(e){return e.replace(/start|end/g,function(t){return Nr[t]})}function st(e){var t=W(e),n=t.pageXOffset,r=t.pageYOffset;return{scrollLeft:n,scrollTop:r}}function at(e){return ve(se(e)).left+st(e).scrollLeft}function Lr(e,t){var n=W(e),r=se(e),o=n.visualViewport,s=r.clientWidth,c=r.clientHeight,i=0,a=0;if(o){s=o.width,c=o.height;var d=Kt();(d||!d&&t==="fixed")&&(i=o.offsetLeft,a=o.offsetTop)}return{width:s,height:c,x:i+at(e),y:a}}function Br(e){var t,n=se(e),r=st(e),o=(t=e.ownerDocument)==null?void 0:t.body,s=ue(n.scrollWidth,n.clientWidth,o?o.scrollWidth:0,o?o.clientWidth:0),c=ue(n.scrollHeight,n.clientHeight,o?o.scrollHeight:0,o?o.clientHeight:0),i=-r.scrollLeft+at(e),a=-r.scrollTop;return ee(o||n).direction==="rtl"&&(i+=ue(n.clientWidth,o?o.clientWidth:0)-s),{width:s,height:c,x:i,y:a}}function it(e){var t=ee(e),n=t.overflow,r=t.overflowX,o=t.overflowY;return/auto|scroll|overlay|hidden/.test(n+o+r)}function Jt(e){return["html","body","#document"].indexOf(J(e))>=0?e.ownerDocument.body:H(e)&&it(e)?e:Jt($e(e))}function Ce(e,t){var n;t===void 0&&(t=[]);var r=Jt(e),o=r===((n=e.ownerDocument)==null?void 0:n.body),s=W(r),c=o?[s].concat(s.visualViewport||[],it(r)?r:[]):r,i=t.concat(c);return o?i:i.concat(Ce($e(c)))}function Ze(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function Fr(e,t){var n=ve(e,!1,t==="fixed");return n.top=n.top+e.clientTop,n.left=n.left+e.clientLeft,n.bottom=n.top+e.clientHeight,n.right=n.left+e.clientWidth,n.width=e.clientWidth,n.height=e.clientHeight,n.x=n.left,n.y=n.top,n}function Dt(e,t,n){return t===Vt?Ze(Lr(e,n)):fe(t)?Fr(t,n):Ze(Br(se(e)))}function zr(e){var t=Ce($e(e)),n=["absolute","fixed"].indexOf(ee(e).position)>=0,r=n&&H(e)?Pe(e):e;return fe(r)?t.filter(function(o){return fe(o)&&qt(o,r)&&J(o)!=="body"}):[]}function $r(e,t,n,r){var o=t==="clippingParents"?zr(e):[].concat(t),s=[].concat(o,[n]),c=s[0],i=s.reduce(function(a,d){var u=Dt(e,d,r);return a.top=ue(u.top,a.top),a.right=Be(u.right,a.right),a.bottom=Be(u.bottom,a.bottom),a.left=ue(u.left,a.left),a},Dt(e,c,r));return i.width=i.right-i.left,i.height=i.bottom-i.top,i.x=i.left,i.y=i.top,i}function Zt(e){var t=e.reference,n=e.element,r=e.placement,o=r?G(r):null,s=r?ge(r):null,c=t.x+t.width/2-n.width/2,i=t.y+t.height/2-n.height/2,a;switch(o){case z:a={x:c,y:t.y-n.height};break;case K:a={x:c,y:t.y+t.height};break;case q:a={x:t.x+t.width,y:i};break;case $:a={x:t.x-n.width,y:i};break;default:a={x:t.x,y:t.y}}var d=o?ot(o):null;if(d!=null){var u=d==="y"?"height":"width";switch(s){case me:a[d]=a[d]-(t[u]/2-n[u]/2);break;case Se:a[d]=a[d]+(t[u]/2-n[u]/2);break}}return a}function ke(e,t){t===void 0&&(t={});var n=t,r=n.placement,o=r===void 0?e.placement:r,s=n.strategy,c=s===void 0?e.strategy:s,i=n.boundary,a=i===void 0?ar:i,d=n.rootBoundary,u=d===void 0?Vt:d,v=n.elementContext,C=v===void 0?ye:v,m=n.altBoundary,D=m===void 0?!1:m,y=n.padding,h=y===void 0?0:y,j=Yt(typeof h!="number"?h:Gt(h,De)),g=C===ye?ir:ye,b=e.rects.popper,w=e.elements[D?g:C],E=$r(fe(w)?w:w.contextElement||se(e.elements.popper),a,u,c),S=ve(e.elements.reference),k=Zt({reference:S,element:b,placement:o}),P=Ze(Object.assign({},b,k)),M=C===ye?P:S,f={top:E.top-M.top+j.top,bottom:M.bottom-E.bottom+j.bottom,left:E.left-M.left+j.left,right:M.right-E.right+j.right},O=e.modifiersData.offset;if(C===ye&&O){var T=O[o];Object.keys(f).forEach(function(I){var A=[q,K].indexOf(I)>=0?1:-1,V=[z,K].indexOf(I)>=0?"y":"x";f[I]+=T[V]*A})}return f}function _r(e,t){t===void 0&&(t={});var n=t,r=n.placement,o=n.boundary,s=n.rootBoundary,c=n.padding,i=n.flipVariations,a=n.allowedAutoPlacements,d=a===void 0?Ht:a,u=ge(r),v=u?i?Ct:Ct.filter(function(D){return ge(D)===u}):De,C=v.filter(function(D){return d.indexOf(D)>=0});C.length===0&&(C=v);var m=C.reduce(function(D,y){return D[y]=ke(e,{placement:y,boundary:o,rootBoundary:s,padding:c})[G(y)],D},{});return Object.keys(m).sort(function(D,y){return m[D]-m[y]})}function Ur(e){if(G(e)===tt)return[];var t=Le(e);return[kt(e),t,kt(t)]}function Wr(e){var t=e.state,n=e.options,r=e.name;if(!t.modifiersData[r]._skip){for(var o=n.mainAxis,s=o===void 0?!0:o,c=n.altAxis,i=c===void 0?!0:c,a=n.fallbackPlacements,d=n.padding,u=n.boundary,v=n.rootBoundary,C=n.altBoundary,m=n.flipVariations,D=m===void 0?!0:m,y=n.allowedAutoPlacements,h=t.options.placement,j=G(h),g=j===h,b=a||(g||!D?[Le(h)]:Ur(h)),w=[h].concat(b).reduce(function(B,Z){return B.concat(G(Z)===tt?_r(t,{placement:Z,boundary:u,rootBoundary:v,padding:d,flipVariations:D,allowedAutoPlacements:y}):Z)},[]),E=t.rects.reference,S=t.rects.popper,k=new Map,P=!0,M=w[0],f=0;f<w.length;f++){var O=w[f],T=G(O),I=ge(O)===me,A=[z,K].indexOf(T)>=0,V=A?"width":"height",N=ke(t,{placement:O,boundary:u,rootBoundary:v,altBoundary:C,padding:d}),x=A?I?q:$:I?K:z;E[V]>S[V]&&(x=Le(x));var X=Le(x),_=[];if(s&&_.push(N[T]<=0),i&&_.push(N[x]<=0,N[X]<=0),_.every(function(B){return B})){M=O,P=!1;break}k.set(O,_)}if(P)for(var ae=D?3:1,xe=function(Z){var pe=w.find(function(Te){var ce=k.get(Te);if(ce)return ce.slice(0,Z).every(function(_e){return _e})});if(pe)return M=pe,"break"},ie=ae;ie>0;ie--){var F=xe(ie);if(F==="break")break}t.placement!==M&&(t.modifiersData[r]._skip=!0,t.placement=M,t.reset=!0)}}const Vr={name:"flip",enabled:!0,phase:"main",fn:Wr,requiresIfExists:["offset"],data:{_skip:!1}};function Pt(e,t,n){return n===void 0&&(n={x:0,y:0}),{top:e.top-t.height-n.y,right:e.right-t.width+n.x,bottom:e.bottom-t.height+n.y,left:e.left-t.width-n.x}}function Mt(e){return[z,q,K,$].some(function(t){return e[t]>=0})}function Hr(e){var t=e.state,n=e.name,r=t.rects.reference,o=t.rects.popper,s=t.modifiersData.preventOverflow,c=ke(t,{elementContext:"reference"}),i=ke(t,{altBoundary:!0}),a=Pt(c,r),d=Pt(i,o,s),u=Mt(a),v=Mt(d);t.modifiersData[n]={referenceClippingOffsets:a,popperEscapeOffsets:d,isReferenceHidden:u,hasPopperEscaped:v},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":u,"data-popper-escaped":v})}const Kr={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:Hr};function qr(e,t,n){var r=G(e),o=[$,z].indexOf(r)>=0?-1:1,s=typeof n=="function"?n(Object.assign({},t,{placement:e})):n,c=s[0],i=s[1];return c=c||0,i=(i||0)*o,[$,q].indexOf(r)>=0?{x:i,y:c}:{x:c,y:i}}function Xr(e){var t=e.state,n=e.options,r=e.name,o=n.offset,s=o===void 0?[0,0]:o,c=Ht.reduce(function(u,v){return u[v]=qr(v,t.rects,s),u},{}),i=c[t.placement],a=i.x,d=i.y;t.modifiersData.popperOffsets!=null&&(t.modifiersData.popperOffsets.x+=a,t.modifiersData.popperOffsets.y+=d),t.modifiersData[r]=c}const Yr={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:Xr};function Gr(e){var t=e.state,n=e.name;t.modifiersData[n]=Zt({reference:t.rects.reference,element:t.rects.popper,placement:t.placement})}const Jr={name:"popperOffsets",enabled:!0,phase:"read",fn:Gr,data:{}};function Zr(e){return e==="x"?"y":"x"}function Qr(e){var t=e.state,n=e.options,r=e.name,o=n.mainAxis,s=o===void 0?!0:o,c=n.altAxis,i=c===void 0?!1:c,a=n.boundary,d=n.rootBoundary,u=n.altBoundary,v=n.padding,C=n.tether,m=C===void 0?!0:C,D=n.tetherOffset,y=D===void 0?0:D,h=ke(t,{boundary:a,rootBoundary:d,padding:v,altBoundary:u}),j=G(t.placement),g=ge(t.placement),b=!g,w=ot(j),E=Zr(w),S=t.modifiersData.popperOffsets,k=t.rects.reference,P=t.rects.popper,M=typeof y=="function"?y(Object.assign({},t.rects,{placement:t.placement})):y,f=typeof M=="number"?{mainAxis:M,altAxis:M}:Object.assign({mainAxis:0,altAxis:0},M),O=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,T={x:0,y:0};if(S){if(s){var I,A=w==="y"?z:$,V=w==="y"?K:q,N=w==="y"?"height":"width",x=S[w],X=x+h[A],_=x-h[V],ae=m?-P[N]/2:0,xe=g===me?k[N]:P[N],ie=g===me?-P[N]:-k[N],F=t.elements.arrow,B=m&&F?rt(F):{width:0,height:0},Z=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:Xt(),pe=Z[A],Te=Z[V],ce=Ee(0,k[N],B[N]),_e=b?k[N]/2-ae-ce-pe-f.mainAxis:xe-ce-pe-f.mainAxis,an=b?-k[N]/2+ae+ce+Te+f.mainAxis:ie+ce+Te+f.mainAxis,Ue=t.elements.arrow&&Pe(t.elements.arrow),cn=Ue?w==="y"?Ue.clientTop||0:Ue.clientLeft||0:0,ct=(I=O?.[w])!=null?I:0,ln=x+_e-ct-cn,un=x+an-ct,lt=Ee(m?Be(X,ln):X,x,m?ue(_,un):_);S[w]=lt,T[w]=lt-x}if(i){var ut,dn=w==="x"?z:$,fn=w==="x"?K:q,le=S[E],Ae=E==="y"?"height":"width",dt=le+h[dn],ft=le-h[fn],We=[z,$].indexOf(j)!==-1,pt=(ut=O?.[E])!=null?ut:0,mt=We?dt:le-k[Ae]-P[Ae]-pt+f.altAxis,ht=We?le+k[Ae]+P[Ae]-pt-f.altAxis:ft,vt=m&&We?Er(mt,le,ht):Ee(m?mt:dt,le,m?ht:ft);S[E]=vt,T[E]=vt-le}t.modifiersData[r]=T}}const eo={name:"preventOverflow",enabled:!0,phase:"main",fn:Qr,requiresIfExists:["offset"]};function to(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}}function no(e){return e===W(e)||!H(e)?st(e):to(e)}function ro(e){var t=e.getBoundingClientRect(),n=he(t.width)/e.offsetWidth||1,r=he(t.height)/e.offsetHeight||1;return n!==1||r!==1}function oo(e,t,n){n===void 0&&(n=!1);var r=H(t),o=H(t)&&ro(t),s=se(t),c=ve(e,o,n),i={scrollLeft:0,scrollTop:0},a={x:0,y:0};return(r||!r&&!n)&&((J(t)!=="body"||it(s))&&(i=no(t)),H(t)?(a=ve(t,!0),a.x+=t.clientLeft,a.y+=t.clientTop):s&&(a.x=at(s))),{x:c.left+i.scrollLeft-a.x,y:c.top+i.scrollTop-a.y,width:c.width,height:c.height}}function so(e){var t=new Map,n=new Set,r=[];e.forEach(function(s){t.set(s.name,s)});function o(s){n.add(s.name);var c=[].concat(s.requires||[],s.requiresIfExists||[]);c.forEach(function(i){if(!n.has(i)){var a=t.get(i);a&&o(a)}}),r.push(s)}return e.forEach(function(s){n.has(s.name)||o(s)}),r}function ao(e){var t=so(e);return gr.reduce(function(n,r){return n.concat(t.filter(function(o){return o.phase===r}))},[])}function io(e){var t;return function(){return t||(t=new Promise(function(n){Promise.resolve().then(function(){t=void 0,n(e())})})),t}}function co(e){var t=e.reduce(function(n,r){var o=n[r.name];return n[r.name]=o?Object.assign({},o,r,{options:Object.assign({},o.options,r.options),data:Object.assign({},o.data,r.data)}):r,n},{});return Object.keys(t).map(function(n){return t[n]})}var It={placement:"bottom",modifiers:[],strategy:"absolute"};function Tt(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return!t.some(function(r){return!(r&&typeof r.getBoundingClientRect=="function")})}function lo(e){e===void 0&&(e={});var t=e,n=t.defaultModifiers,r=n===void 0?[]:n,o=t.defaultOptions,s=o===void 0?It:o;return function(i,a,d){d===void 0&&(d=s);var u={placement:"bottom",orderedModifiers:[],options:Object.assign({},It,s),modifiersData:{},elements:{reference:i,popper:a},attributes:{},styles:{}},v=[],C=!1,m={state:u,setOptions:function(j){var g=typeof j=="function"?j(u.options):j;y(),u.options=Object.assign({},s,u.options,g),u.scrollParents={reference:fe(i)?Ce(i):i.contextElement?Ce(i.contextElement):[],popper:Ce(a)};var b=ao(co([].concat(r,u.options.modifiers)));return u.orderedModifiers=b.filter(function(w){return w.enabled}),D(),m.update()},forceUpdate:function(){if(!C){var j=u.elements,g=j.reference,b=j.popper;if(Tt(g,b)){u.rects={reference:oo(g,Pe(b),u.options.strategy==="fixed"),popper:rt(b)},u.reset=!1,u.placement=u.options.placement,u.orderedModifiers.forEach(function(f){return u.modifiersData[f.name]=Object.assign({},f.data)});for(var w=0;w<u.orderedModifiers.length;w++){if(u.reset===!0){u.reset=!1,w=-1;continue}var E=u.orderedModifiers[w],S=E.fn,k=E.options,P=k===void 0?{}:k,M=E.name;typeof S=="function"&&(u=S({state:u,options:P,name:M,instance:m})||u)}}}},update:io(function(){return new Promise(function(h){m.forceUpdate(),h(u)})}),destroy:function(){y(),C=!0}};if(!Tt(i,a))return m;m.setOptions(d).then(function(h){!C&&d.onFirstUpdate&&d.onFirstUpdate(h)});function D(){u.orderedModifiers.forEach(function(h){var j=h.name,g=h.options,b=g===void 0?{}:g,w=h.effect;if(typeof w=="function"){var E=w({state:u,name:j,instance:m,options:b}),S=function(){};v.push(E||S)}})}function y(){v.forEach(function(h){return h()}),v=[]}return m}}var uo=[Ar,Jr,Ir,yr,Yr,Vr,eo,kr,Kr],fo=lo({defaultModifiers:uo});const we=(e,t)=>({var:e,varRef:t?`var(${e}, ${t})`:`var(${e})`}),U={arrowSize:we("--popper-arrow-size","8px"),arrowSizeHalf:we("--popper-arrow-size-half"),arrowBg:we("--popper-arrow-bg"),transformOrigin:we("--popper-transform-origin"),arrowOffset:we("--popper-arrow-offset")};function po(e){if(e.includes("top"))return"1px 1px 0px 0 var(--popper-arrow-shadow-color)";if(e.includes("bottom"))return"-1px -1px 0px 0 var(--popper-arrow-shadow-color)";if(e.includes("right"))return"-1px 1px 0px 0 var(--popper-arrow-shadow-color)";if(e.includes("left"))return"1px -1px 0px 0 var(--popper-arrow-shadow-color)"}const mo={top:"bottom center","top-start":"bottom left","top-end":"bottom right",bottom:"top center","bottom-start":"top left","bottom-end":"top right",left:"right center","left-start":"right top","left-end":"right bottom",right:"left center","right-start":"left top","right-end":"left bottom"},ho=e=>mo[e],At={scroll:!0,resize:!0};function vo(e){let t;return typeof e=="object"?t={enabled:!0,options:{...At,...e}}:t={enabled:e,options:At},t}const go={name:"matchWidth",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:({state:e})=>{e.styles.popper.width=`${e.rects.reference.width}px`},effect:({state:e})=>()=>{const t=e.elements.reference;e.elements.popper.style.width=`${t.offsetWidth}px`}},xo={name:"transformOrigin",enabled:!0,phase:"write",fn:({state:e})=>{Rt(e)},effect:({state:e})=>()=>{Rt(e)}},Rt=e=>{e.elements.popper.style.setProperty(U.transformOrigin.var,ho(e.placement))},bo={name:"positionArrow",enabled:!0,phase:"afterWrite",fn:({state:e})=>{yo(e)}},yo=e=>{if(!e.placement)return;const t=wo(e.placement);if(e.elements?.arrow&&t){Object.assign(e.elements.arrow.style,{[t.property]:t.value,width:U.arrowSize.varRef,height:U.arrowSize.varRef,zIndex:-1});const n={[U.arrowSizeHalf.var]:`calc(${U.arrowSize.varRef} / 2 - 1px)`,[U.arrowOffset.var]:`calc(${U.arrowSizeHalf.varRef} * -1)`};for(const r in n)e.elements.arrow.style.setProperty(r,n[r])}},wo=e=>{if(e.startsWith("top"))return{property:"bottom",value:U.arrowOffset.varRef};if(e.startsWith("bottom"))return{property:"top",value:U.arrowOffset.varRef};if(e.startsWith("left"))return{property:"right",value:U.arrowOffset.varRef};if(e.startsWith("right"))return{property:"left",value:U.arrowOffset.varRef}},Oo={name:"innerArrow",enabled:!0,phase:"main",requires:["arrow"],fn:({state:e})=>{Nt(e)},effect:({state:e})=>()=>{Nt(e)}},Nt=e=>{if(!e.elements.arrow)return;const t=e.elements.arrow.querySelector("[data-popper-arrow-inner]");if(!t)return;const n=po(e.placement);n&&t.style.setProperty("--popper-arrow-default-shadow",n),Object.assign(t.style,{transform:"rotate(45deg)",background:U.arrowBg.varRef,top:0,left:0,width:"100%",height:"100%",position:"absolute",zIndex:"inherit",boxShadow:"var(--popper-arrow-shadow, var(--popper-arrow-default-shadow))"})},Eo={"start-start":{ltr:"left-start",rtl:"right-start"},"start-end":{ltr:"left-end",rtl:"right-end"},"end-start":{ltr:"right-start",rtl:"left-start"},"end-end":{ltr:"right-end",rtl:"left-end"},start:{ltr:"left",rtl:"right"},end:{ltr:"right",rtl:"left"}},Co={"auto-start":"auto-end","auto-end":"auto-start","top-start":"top-end","top-end":"top-start","bottom-start":"bottom-end","bottom-end":"bottom-start"};function jo(e,t="ltr"){const n=Eo[e]?.[t]||e;return t==="ltr"?n:Co[e]??n}function So(e={}){const{enabled:t=!0,modifiers:n,placement:r="bottom",strategy:o="absolute",arrowPadding:s=8,eventListeners:c=!0,offset:i,gutter:a=8,flip:d=!0,boundary:u="clippingParents",preventOverflow:v=!0,matchWidth:C,direction:m="ltr"}=e,D=p.useRef(null),y=p.useRef(null),h=p.useRef(null),j=jo(r,m),g=p.useRef(()=>{}),b=p.useCallback(()=>{!t||!D.current||!y.current||(g.current?.(),h.current=fo(D.current,y.current,{placement:j,modifiers:[Oo,bo,xo,{...go,enabled:!!C},{name:"eventListeners",...vo(c)},{name:"arrow",options:{padding:s}},{name:"offset",options:{offset:i??[0,a]}},{name:"flip",enabled:!!d,options:{padding:8}},{name:"preventOverflow",enabled:!!v,options:{boundary:u}},...n??[]],strategy:o}),h.current.forceUpdate(),g.current=h.current.destroy)},[j,t,n,C,c,s,i,a,d,v,u,o]);p.useEffect(()=>()=>{!D.current&&!y.current&&(h.current?.destroy(),h.current=null)},[]);const w=p.useCallback(f=>{D.current=f,b()},[b]),E=p.useCallback((f={},O=null)=>({...f,ref:de(w,O)}),[w]),S=p.useCallback(f=>{y.current=f,b()},[b]),k=p.useCallback((f={},O=null)=>({...f,ref:de(S,O),style:{...f.style,position:o,minWidth:C?void 0:"max-content",inset:"0 auto auto 0"}}),[o,S,C]),P=p.useCallback((f={},O=null)=>{const{size:T,shadowColor:I,bg:A,style:V,...N}=f;return{...N,ref:O,"data-popper-arrow":"",style:ko(f)}},[]),M=p.useCallback((f={},O=null)=>({...f,ref:O,"data-popper-arrow-inner":""}),[]);return{update(){h.current?.update()},forceUpdate(){h.current?.forceUpdate()},transformOrigin:U.transformOrigin.varRef,referenceRef:w,popperRef:S,getPopperProps:k,getArrowProps:P,getArrowInnerProps:M,getReferenceProps:E}}function ko(e){const{size:t,shadowColor:n,bg:r,style:o}=e,s={...o,position:"absolute"};return t&&(s["--popper-arrow-size"]=t),n&&(s["--popper-arrow-shadow-color"]=n),r&&(s["--popper-arrow-bg"]=r),s}function Do(){const e=p.useRef(new Map),t=e.current,n=p.useCallback((o,s,c,i)=>{e.current.set(c,{type:s,el:o,options:i}),o.addEventListener(s,c,i)},[]),r=p.useCallback((o,s,c,i)=>{o.removeEventListener(s,c,i),e.current.delete(c)},[]);return p.useEffect(()=>()=>{t.forEach((o,s)=>{r(o.el,o.type,s,o.options)})},[r,t]),{add:n,remove:r}}function Xe(e){const t=e.composedPath?.()?.[0]??e.target,{tagName:n,isContentEditable:r}=t;return n!=="INPUT"&&n!=="TEXTAREA"&&r!==!0}function Po(e={}){const{ref:t,isDisabled:n,isFocusable:r,clickOnEnter:o=!0,clickOnSpace:s=!0,onMouseDown:c,onMouseUp:i,onClick:a,onKeyDown:d,onKeyUp:u,tabIndex:v,onMouseOver:C,onMouseLeave:m,...D}=e,[y,h]=p.useState(!0),[j,g]=p.useState(!1),b=Do(),w=x=>{x&&x.tagName!=="BUTTON"&&h(!1)},E=y?v:v||0,S=n&&!r,k=p.useCallback(x=>{if(n){x.stopPropagation(),x.preventDefault();return}x.currentTarget.focus(),a?.(x)},[n,a]),P=p.useCallback(x=>{j&&Xe(x)&&(x.preventDefault(),x.stopPropagation(),g(!1),b.remove(document,"keyup",P,!1))},[j,b]),M=p.useCallback(x=>{if(d?.(x),n||x.defaultPrevented||x.metaKey||!Xe(x.nativeEvent)||y)return;const X=o&&x.key==="Enter";s&&x.key===" "&&(x.preventDefault(),g(!0)),X&&(x.preventDefault(),x.currentTarget.click()),b.add(document,"keyup",P,!1)},[n,y,d,o,s,b,P]),f=p.useCallback(x=>{if(u?.(x),n||x.defaultPrevented||x.metaKey||!Xe(x.nativeEvent)||y)return;s&&x.key===" "&&(x.preventDefault(),g(!1),x.currentTarget.click())},[s,y,n,u]),O=p.useCallback(x=>{x.button===0&&(g(!1),b.remove(document,"mouseup",O,!1))},[b]),T=p.useCallback(x=>{if(x.button!==0)return;if(n){x.stopPropagation(),x.preventDefault();return}y||g(!0),x.currentTarget.focus({preventScroll:!0}),b.add(document,"mouseup",O,!1),c?.(x)},[n,y,c,b,O]),I=p.useCallback(x=>{x.button===0&&(y||g(!1),i?.(x))},[i,y]),A=p.useCallback(x=>{if(n){x.preventDefault();return}C?.(x)},[n,C]),V=p.useCallback(x=>{j&&(x.preventDefault(),g(!1)),m?.(x)},[j,m]),N=de(t,w);return y?{...D,ref:N,type:"button","aria-disabled":S?void 0:n,disabled:S,onClick:k,onMouseDown:c,onMouseUp:i,onKeyUp:u,onKeyDown:d,onMouseOver:C,onMouseLeave:m}:{...D,ref:N,role:"button","data-active":Bt(j),"aria-disabled":n?"true":void 0,tabIndex:S?void 0:E,onClick:k,onMouseDown:T,onMouseUp:I,onKeyUp:f,onKeyDown:M,onMouseOver:A,onMouseLeave:V}}const[Mo,Io,To,Ao]=nr(),[Ro,Me]=Fe({strict:!1,name:"MenuContext"});function Qt(e){return e?.ownerDocument??document}function No(e){return Qt(e).activeElement===e}function Lo(e={}){const{id:t,closeOnSelect:n=!0,closeOnBlur:r=!0,initialFocusRef:o,autoSelect:s=!0,isLazy:c,isOpen:i,defaultIsOpen:a,onClose:d,onOpen:u,placement:v="bottom-start",lazyBehavior:C="unmount",direction:m,computePositionOnMount:D=!1,...y}=e,h=p.useRef(null),j=p.useRef(null),g=p.useRef(!0),b=To(),w=p.useCallback(()=>{requestAnimationFrame(()=>{h.current?.focus({preventScroll:!1})})},[]),E=p.useCallback(()=>{const F=setTimeout(()=>{if(o)o.current?.focus();else if(!b.count())h.current?.focus({preventScroll:!1});else{const B=b.firstEnabled();B&&A(B.index)}});_.current.add(F)},[b,o]),S=p.useCallback(()=>{const F=setTimeout(()=>{if(!b.count())h.current?.focus({preventScroll:!1});else{const B=b.lastEnabled();B&&A(B.index)}});_.current.add(F)},[b]),k=p.useCallback(()=>{u?.(),s?E():w()},[s,E,w,u]),{isOpen:P,onOpen:M,onClose:f,onToggle:O}=_t({isOpen:i,defaultIsOpen:a,onClose:d,onOpen:k});Jn({enabled:P&&r,ref:h,handler:F=>{const B=F.composedPath?.()?.[0]??F.target;j.current?.contains(B)||f()}});const T=So({...y,enabled:P||D,placement:v,direction:m}),[I,A]=p.useState(-1);Xn(h,{focusRef:j,visible:P});const V=Kn({isOpen:P,ref:h}),[N,x]=Gn(t,"menu-button","menu-list"),X=p.useCallback(()=>{M(),w()},[M,w]),_=p.useRef(new Set([]));p.useEffect(()=>{const F=_.current;return()=>{F.forEach(B=>clearTimeout(B)),F.clear()}},[]),Ye(()=>{P||(A(-1),h.current?.scrollTo(0,0))},[P]),Ye(()=>{P&&I===-1&&w()},[I,P]),p.useEffect(()=>{if(!P)return;b.item(I)?.node?.focus({preventScroll:!g.current})},[b,I,P]);const ae=p.useCallback(()=>{M(),E()},[E,M]),xe=p.useCallback(()=>{g.current=!0,M(),S()},[M,S]),ie=p.useCallback(()=>{const F=Qt(h.current),B=h.current?.contains(F.activeElement);if(!(P&&!B))return;b.item(I)?.node?.focus({preventScroll:!g.current})},[P,I,b]);return{openAndFocusMenu:X,openAndFocusFirstItem:ae,openAndFocusLastItem:xe,onTransitionEnd:ie,unstable__animationState:V,descendants:b,popper:T,buttonId:N,menuId:x,forceUpdate:T.forceUpdate,orientation:"vertical",isOpen:P,onToggle:O,onOpen:M,onClose:f,menuRef:h,buttonRef:j,focusedIndex:I,closeOnSelect:n,closeOnBlur:r,autoSelect:s,setFocusedIndex:A,isLazy:c,lazyBehavior:C,initialFocusRef:o,scrollIntoViewRef:g}}function Bo(e={},t=null){const n=Me(),{onToggle:r,popper:o,openAndFocusFirstItem:s,openAndFocusLastItem:c,scrollIntoViewRef:i}=n,a=p.useCallback(d=>{const u=d.key,C={Enter:s,ArrowDown:s,ArrowUp:c}[u];C&&(i.current=!0,d.preventDefault(),d.stopPropagation(),C(d))},[s,c,i]);return{...e,ref:de(n.buttonRef,t,o.referenceRef),id:n.buttonId,"data-active":Bt(n.isOpen),"aria-expanded":n.isOpen,"aria-haspopup":"menu","aria-controls":n.menuId,onClick:Ge(e.onClick,r),onKeyDown:Ge(e.onKeyDown,a)}}function Qe(e){return _o(e)&&!!e?.getAttribute("role")?.startsWith("menuitem")}function Fo(e={},t=null){const n=Me();if(!n)throw new Error("useMenuContext: context is undefined. Seems you forgot to wrap component within <Menu>");const{focusedIndex:r,setFocusedIndex:o,menuRef:s,isOpen:c,onClose:i,menuId:a,isLazy:d,lazyBehavior:u,scrollIntoViewRef:v,unstable__animationState:C}=n,m=Io(),D=sr({preventDefault:g=>g.key!==" "&&Qe(g.target)}),y=p.useCallback(g=>{if(!g.currentTarget.contains(g.target))return;const b=g.key,E={Tab:k=>k.preventDefault(),Escape:k=>{k.stopPropagation(),i()},ArrowDown:()=>{v.current=!0;const k=m.nextEnabled(r)??m.firstEnabled();k&&o(k.index)},ArrowUp:()=>{v.current=!0;const k=m.prevEnabled(r)??m.firstEnabled();k&&o(k.index)}}[b];if(E){g.preventDefault(),E(g);return}const S=D(k=>{const P=rr(m.values(),k,M=>M?.node?.textContent??"",m.item(r));if(P){const M=m.indexOf(P.node);o(M)}});Qe(g.target)&&S(g)},[m,r,D,i,o,v]),h=p.useRef(!1);c&&(h.current=!0);const j=Vn({wasSelected:h.current,enabled:d,mode:u,isSelected:C.present});return{...e,ref:de(s,t),children:j?e.children:null,tabIndex:-1,role:"menu",id:a,style:{...e.style,transformOrigin:"var(--popper-transform-origin)"},"aria-orientation":"vertical",onKeyDown:Ge(e.onKeyDown,y)}}function zo(e={}){const{popper:t,isOpen:n}=Me();return t.getPopperProps({...e,style:{visibility:n?"visible":"hidden",...e.style}})}function $o(e={},t=null){const{onMouseEnter:n,onMouseMove:r,onMouseLeave:o,onClick:s,onFocus:c,isDisabled:i,isFocusable:a,closeOnSelect:d,type:u,...v}=e,C=Me(),{setFocusedIndex:m,focusedIndex:D,closeOnSelect:y,onClose:h,menuId:j,scrollIntoViewRef:g}=C,b=p.useRef(null),w=`${j}-menuitem-${p.useId()}`,{index:E,register:S}=Ao({disabled:i&&!a}),k=p.useCallback(A=>{n?.(A),!i&&(g.current=!1,m(E))},[m,E,i,n,g]),P=p.useCallback(A=>{r?.(A),b.current&&!No(b.current)&&k(A)},[k,r]),M=p.useCallback(A=>{o?.(A),!i&&m(-1)},[m,i,o]),f=p.useCallback(A=>{s?.(A),Qe(A.currentTarget)&&(d??y)&&h()},[h,s,y,d]),O=p.useCallback(A=>{c?.(A),m(E)},[m,c,E]),T=E===D,I=Po({onClick:f,onFocus:O,onMouseEnter:k,onMouseMove:P,onMouseLeave:M,ref:de(S,b,t),isDisabled:i,isFocusable:a});return{...v,...I,type:u??I.type,id:w,role:"menuitem",tabIndex:T?0:-1}}function _o(e){if(!Uo(e))return!1;const t=e.ownerDocument.defaultView??window;return e instanceof t.HTMLElement}function Uo(e){return e!=null&&typeof e=="object"&&"nodeType"in e&&e.nodeType===Node.ELEMENT_NODE}const[Wo,Ie]=Fe({name:"MenuStylesContext",errorMessage:`useMenuStyles returned is 'undefined'. Seems you forgot to wrap the components in "<Menu />" `}),en=e=>{const{children:t}=e,n=Ft("Menu",e),r=zt(e),{direction:o}=mn(),{descendants:s,...c}=Lo({...r,direction:o}),i=p.useMemo(()=>c,[c]),{isOpen:a,onClose:d,forceUpdate:u}=i;return l.jsx(Mo,{value:s,children:l.jsx(Ro,{value:i,children:l.jsx(Wo,{value:n,children:hn(t,{isOpen:a,onClose:d,forceUpdate:u})})})})};en.displayName="Menu";const Vo=te((e,t)=>{const n=Ie();return l.jsx(ne.button,{ref:t,...e,__css:{display:"inline-flex",appearance:"none",alignItems:"center",outline:0,...n.button}})}),tn=te((e,t)=>{const{children:n,as:r,...o}=e,s=Bo(o,t),c=r||Vo;return l.jsx(c,{...s,className:je("chakra-menu__menu-button",e.className),children:l.jsx(ne.span,{__css:{pointerEvents:"none",flex:"1 1 auto",minW:0},children:e.children})})});tn.displayName="MenuButton";const nn=te((e,t)=>{const n=Ie();return l.jsx(ne.span,{ref:t,...e,__css:n.command,className:"chakra-menu__command"})});nn.displayName="MenuCommand";const rn=e=>{const{className:t,children:n,...r}=e,o=Ie(),s=p.Children.only(n),c=p.isValidElement(s)?p.cloneElement(s,{focusable:"false","aria-hidden":!0,className:je("chakra-menu__icon",s.props.className)}):null,i=je("chakra-menu__icon-wrapper",t);return l.jsx(ne.span,{className:i,...r,__css:o.icon,children:c})};rn.displayName="MenuIcon";const Ho=te((e,t)=>{const{type:n,...r}=e,o=Ie(),s=r.as||n?n??void 0:"button",c=p.useMemo(()=>({textDecoration:"none",color:"inherit",userSelect:"none",display:"flex",width:"100%",alignItems:"center",textAlign:"start",flex:"0 0 auto",outline:0,...o.item}),[o.item]);return l.jsx(ne.button,{ref:t,type:s,...r,__css:c})}),et=te((e,t)=>{const{icon:n,iconSpacing:r="0.75rem",command:o,commandSpacing:s="0.75rem",children:c,...i}=e,a=$o(i,t),u=n||o?l.jsx("span",{style:{pointerEvents:"none",flex:1},children:c}):c;return l.jsxs(Ho,{...a,className:je("chakra-menu__menuitem",a.className),children:[n&&l.jsx(rn,{fontSize:"0.8em",marginEnd:r,children:n}),u,o&&l.jsx(nn,{marginStart:s,children:o})]})});et.displayName="MenuItem";const Ko={enter:{visibility:"visible",opacity:1,scale:1,transition:{duration:.2,ease:[.4,0,.2,1]}},exit:{transitionEnd:{visibility:"hidden"},opacity:0,scale:.8,transition:{duration:.1,easings:"easeOut"}}},qo=ne(gn.div),on=te(function(t,n){const{rootProps:r,motionProps:o,...s}=t,{isOpen:c,onTransitionEnd:i,unstable__animationState:a}=Me(),d=Fo(s,n),u=zo(r),v=Ie();return l.jsx(ne.div,{...u,__css:{zIndex:t.zIndex??v.list?.zIndex},children:l.jsx(qo,{variants:Ko,initial:!1,animate:c?"enter":"exit",__css:{outline:0,...v.list},...o,...d,className:je("chakra-menu__menu-list",d.className),onUpdate:i,onAnimationComplete:vn(a.onComplete,d.onAnimationComplete)})})});on.displayName="MenuList";function Xo(e,t,n){return(e-t)*100/(n-t)}ze({"0%":{strokeDasharray:"1, 400",strokeDashoffset:"0"},"50%":{strokeDasharray:"400, 400",strokeDashoffset:"-100"},"100%":{strokeDasharray:"400, 400",strokeDashoffset:"-260"}});ze({"0%":{transform:"rotate(0deg)"},"100%":{transform:"rotate(360deg)"}});const Yo=ze({"0%":{left:"-40%"},"100%":{left:"100%"}}),Go=ze({from:{backgroundPosition:"1rem 0"},to:{backgroundPosition:"0 0"}});function Jo(e){const{value:t=0,min:n,max:r,valueText:o,getValueText:s,isIndeterminate:c,role:i="progressbar"}=e,a=Xo(t,n,r);return{bind:{"data-indeterminate":c?"":void 0,"aria-valuemax":r,"aria-valuemin":n,"aria-valuenow":c?void 0:t,"aria-valuetext":(()=>{if(t!=null)return typeof s=="function"?s(t,a):o})(),role:i},percent:a,value:t}}const[Zo,Qo]=Fe({name:"ProgressStylesContext",errorMessage:`useProgressStyles returned is 'undefined'. Seems you forgot to wrap the components in "<Progress />" `}),es=te((e,t)=>{const{min:n,max:r,value:o,isIndeterminate:s,role:c,...i}=e,a=Jo({value:o,min:n,max:r,isIndeterminate:s,role:c}),u={height:"100%",...Qo().filledTrack};return l.jsx(ne.div,{ref:t,style:{width:`${a.percent}%`,...i.style},...a.bind,...i,__css:u})}),sn=te((e,t)=>{const{value:n,min:r=0,max:o=100,hasStripe:s,isAnimated:c,children:i,borderRadius:a,isIndeterminate:d,"aria-label":u,"aria-labelledby":v,"aria-valuetext":C,title:m,role:D,...y}=zt(e),h=Ft("Progress",e),j=a??h.track?.borderRadius,g={animation:`${Go} 1s linear infinite`},E={...!d&&s&&c&&g,...d&&{position:"absolute",willChange:"left",minWidth:"50%",animation:`${Yo} 1s ease infinite normal none running`}},S={overflow:"hidden",position:"relative",...h.track};return l.jsx(ne.div,{ref:t,borderRadius:j,__css:S,...y,children:l.jsxs(Zo,{value:h,children:[l.jsx(es,{"aria-label":u,"aria-labelledby":v,"aria-valuetext":C,min:r,max:o,value:n,isIndeterminate:d,css:E,borderRadius:j,title:m,role:D}),i]})})});sn.displayName="Progress";const Oe=te((e,t)=>l.jsx(Nn,{align:"center",...e,direction:"column",ref:t}));Oe.displayName="VStack";/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ts=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],ns=$t("funnel",ts);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rs=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],os=$t("upload",rs),xs=()=>{const e=xn(),{isOpen:t,onOpen:n,onClose:r}=_t(),[o,s]=p.useState(null),[c,i]=p.useState(!1),[a,d]=p.useState(null),[u,v]=p.useState([]),[C,m]=p.useState(!1),[D,y]=p.useState(""),[h,j]=p.useState(""),[g,b]=p.useState([]),w=async()=>{m(!0);try{const f={...D&&h&&{startDate:D,endDate:h}},O=await gt.get("/api/savings/logs",{params:f});v(O.data.data||[])}catch{e({title:"Error",description:"Failed to fetch upload logs",status:"error"})}finally{m(!1)}},E=f=>{const O=f.target.files?.[0];if(O){if(!["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel"].includes(O.type)){e({title:"Invalid File Type",description:"Please select an Excel file (.xlsx or .xls)",status:"error"});return}if(O.size>10*1024*1024){e({title:"File Too Large",description:"File size must be less than 10MB",status:"error"});return}s(O)}},S=async()=>{if(!o){e({title:"No File Selected",description:"Please select a file to upload",status:"warning"});return}i(!0);try{const f=new FormData;f.append("file",o),console.log(o),f.append("uploadType","MONTHLY DEDUCTIONS");const O=await gt.post("/api/savings/upload/cooperative-savings",f,{headers:{"Content-Type":void 0}});if(d(O.data),O.data.success){e({title:"Upload Successful",description:`Processed ${O.data.processedCount} records successfully`,status:"success"}),w(),s(null);const T=document.getElementById("file-upload");T&&(T.value="")}else e({title:"Upload Failed",description:"Some records could not be processed",status:"warning"});n()}catch(f){e({title:"Upload Error",description:f instanceof Error?f.message:"Upload failed",status:"error"})}finally{i(!1)}},k=()=>{const f=[["Email","Username","Amount","Name"],["john.doe@example.com","JohnDoe","15000","John Doe"],["jane.smith@example.com","JaneDoe","20000","Jane Smith"]],O=Ve.book_new(),T=Ve.aoa_to_sheet(f);Ve.book_append_sheet(O,T,"Template"),Cn(O,"monthly_deductions_template.xlsx")},P=(f,O)=>{b(O?[...g,f]:g.filter(T=>T!==f))},M=f=>{b(f?u.map(O=>O.id):[])};return p.useEffect(()=>{w()},[D,h]),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("div",{children:l.jsx("h1",{className:"text-2xl font-bold text-teal-600"})}),l.jsxs(en,{children:[l.jsx(tn,{as:be,colorScheme:"teal",size:"sm",rightIcon:l.jsx(os,{size:16}),children:"Bulk Uploads"}),l.jsxs(on,{children:[l.jsx(et,{icon:l.jsx(He,{size:16}),onClick:()=>document.getElementById("file-upload")?.click(),children:"Upload Cooperative Deductions"}),l.jsx(et,{icon:l.jsx(Rn,{size:16}),onClick:k,children:"Download Template"})]})]}),l.jsx("input",{id:"file-upload",type:"file",accept:".xlsx,.xls",onChange:E,style:{display:"none"}})]}),o&&l.jsx(Q,{p:4,bg:"gray.50",borderRadius:"md",border:"1px solid",borderColor:"gray.200",children:l.jsxs(Oe,{spacing:3,children:[l.jsxs(re,{spacing:3,width:"100%",children:[l.jsx(He,{size:20,color:"teal"}),l.jsxs(Oe,{align:"start",spacing:0,flex:1,children:[l.jsx(L,{fontWeight:"medium",children:o.name}),l.jsxs(L,{fontSize:"sm",color:"gray.600",children:[(o.size/1024/1024).toFixed(2)," MB"]})]}),l.jsx(be,{colorScheme:"teal",size:"sm",onClick:S,isLoading:c,loadingText:"Uploading...",children:"Upload File"}),l.jsx(be,{variant:"ghost",size:"sm",onClick:()=>{s(null);const f=document.getElementById("file-upload");f&&(f.value="")},children:"Cancel"})]}),c&&l.jsxs(Q,{width:"100%",children:[l.jsx(sn,{size:"sm",isIndeterminate:!0,colorScheme:"teal"}),l.jsx(L,{fontSize:"sm",color:"gray.600",mt:1,children:"Processing file... This may take a few minutes."})]})]})}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("p",{className:"text-lg font-semibold text-teal-600",children:"Upload Deductions"}),l.jsxs(re,{spacing:4,children:[l.jsxs(re,{children:[l.jsx(L,{fontSize:"sm",children:"From"}),l.jsx(bt,{type:"date",value:D,onChange:f=>y(f.target.value),size:"sm",width:"150px"})]}),l.jsxs(re,{children:[l.jsx(L,{fontSize:"sm",children:"To"}),l.jsx(bt,{type:"date",value:h,onChange:f=>j(f.target.value),size:"sm",width:"150px"})]}),l.jsx(be,{variant:"outline",size:"sm",children:l.jsx(ns,{size:16})})]})]}),l.jsx(Ln,{children:l.jsxs(Bn,{variant:"simple",size:"sm",children:[l.jsx(Fn,{bg:"#F1F4F9",children:l.jsxs(Re,{children:[l.jsx(oe,{children:l.jsx(xt,{isChecked:g.length===u.length&&u.length>0,isIndeterminate:g.length>0&&g.length<u.length,onChange:f=>M(f.target.checked)})}),l.jsx(oe,{children:"File Name"}),l.jsx(oe,{children:"Upload Type"}),l.jsx(oe,{children:"Processed Time"}),l.jsx(oe,{children:"Processed Items"}),l.jsx(oe,{children:"Failed Items"}),l.jsx(oe,{children:"Date"}),l.jsx(oe,{children:"Status"})]})}),l.jsx(zn,{children:C?l.jsx(Re,{children:l.jsxs(Y,{colSpan:7,textAlign:"center",py:8,children:[l.jsx(bn,{size:"sm",mr:2}),"Loading..."]})}):u.length===0?l.jsx(Re,{children:l.jsx(Y,{colSpan:7,textAlign:"center",py:8,color:"gray.500",children:"No Data"})}):u.map(f=>l.jsxs(Re,{_hover:{bg:"gray.50"},children:[l.jsx(Y,{children:l.jsx(xt,{isChecked:g.includes(f.id),onChange:O=>P(f.id,O.target.checked)})}),l.jsx(Y,{children:l.jsxs(re,{children:[l.jsx(He,{size:16,color:"teal"}),l.jsx(L,{fontWeight:"medium",children:f.fileName})]})}),l.jsx(Y,{children:l.jsx($n,{colorScheme:"blue",variant:"subtle",children:f.uploadType})}),l.jsx(Y,{children:f.processedTime}),l.jsx(Y,{children:l.jsxs(re,{children:[l.jsx(jn,{size:14,color:"green"}),l.jsx(L,{children:f.processedItems})]})}),l.jsx(Y,{children:f.failedItems>0?l.jsxs(re,{children:[l.jsx(Sn,{size:14,color:"red"}),l.jsx(L,{color:"red.500",children:f.failedItems})]}):l.jsx(L,{color:"gray.500",children:"0"})}),l.jsx(Y,{children:new Date(f.date).toLocaleDateString()}),l.jsx(Y,{children:l.jsx(L,{fontWeight:"semibold",color:f.status==="COMPLETED"?"green":f.status==="PROCESSING"?"orange":f.status==="FAILED"?"red":"gray",children:f.status})})]},f.id))})]})})]}),l.jsxs(Dn,{isOpen:t,onClose:r,size:"xl",children:[l.jsx(Pn,{}),l.jsxs(Mn,{children:[l.jsx(In,{children:"Upload Results"}),l.jsx(Tn,{}),l.jsx(An,{children:a&&l.jsxs(Oe,{spacing:4,align:"stretch",children:[l.jsxs(yn,{status:a.success?"success":"error",children:[l.jsx(wn,{}),l.jsxs(Q,{children:[l.jsx(On,{children:a.success?"Upload Completed!":"Upload Failed!"}),l.jsxs(En,{children:["Processed ",a.processedCount," records successfully.",a.errorCount>0&&` ${a.errorCount} records failed.`]})]})]}),l.jsxs(re,{spacing:4,children:[l.jsxs(Q,{p:3,bg:"green.50",borderRadius:"md",flex:1,children:[l.jsx(L,{fontSize:"sm",color:"green.600",children:"Total Amount"}),l.jsxs(L,{fontSize:"lg",fontWeight:"bold",color:"green.700",children:["",a.summary.totalAmount.toLocaleString()]})]}),l.jsxs(Q,{p:3,bg:"blue.50",borderRadius:"md",flex:1,children:[l.jsx(L,{fontSize:"sm",color:"blue.600",children:"Valid Records"}),l.jsx(L,{fontSize:"lg",fontWeight:"bold",color:"blue.700",children:a.summary.validRecords})]}),l.jsxs(Q,{p:3,bg:"red.50",borderRadius:"md",flex:1,children:[l.jsx(L,{fontSize:"sm",color:"red.600",children:"Invalid Records"}),l.jsx(L,{fontSize:"lg",fontWeight:"bold",color:"red.700",children:a.summary.invalidRecords})]})]}),a.errors.length>0&&l.jsxs(Q,{children:[l.jsxs(L,{fontWeight:"bold",mb:2,color:"red.600",children:["Errors (",a.errors.length,"):"]}),l.jsx(Q,{maxH:"200px",overflowY:"auto",bg:"red.50",p:3,borderRadius:"md",children:l.jsx(Oe,{spacing:2,align:"stretch",children:a.errors.map((f,O)=>l.jsxs(Q,{p:2,bg:"white",borderRadius:"sm",fontSize:"sm",children:[l.jsxs(L,{fontWeight:"medium",children:["Row ",f.row,f.serviceNumber&&` (${f.serviceNumber})`,":"]}),l.jsx(L,{color:"red.600",children:f.error})]},O))})})]})]})}),l.jsx(_n,{children:l.jsx(be,{onClick:r,children:"Close"})})]})]})]})};export{xs as default};
