import{r as n,j as t,T as m,e as j}from"./index-CRMG5bzS.js";import{D as v}from"./index-D2SIzbjx.js";import{e as k}from"./excelExport-BIpDu_Yb.js";import{H as d}from"./text-DC-W0PyF.js";import{B as w}from"./use-form-control-CQKzOfDr.js";import{I as h}from"./input-BfnAPdur.js";import{B as x}from"./badge-DiIJR_EX.js";import"./fade-BWbPEriw.js";import"./select-C_HCPDtk.js";import"./key-BWXZw050.js";import"./xlsx-3SA47z_C.js";import"./children-aMr2zYAb.js";const H=()=>{const[i,p]=n.useState([]),[f,N]=n.useState(!0),[u,b]=n.useState(""),[a,D]=n.useState(""),[r,y]=n.useState("");n.useEffect(()=>{(async()=>{try{const o=await j.get("/api/admin-report/monthly-deductions");p(o.data)}catch(o){b(o.response?.data?.message||"Failed to fetch deductions data")}finally{N(!1)}})()},[]);const l=n.useMemo(()=>!a&&!r?i:i.filter(e=>{const o=new Date(e.date||e.createdAt),c=a?new Date(a):null,s=r?new Date(r):null;return!(c&&o<c||s&&o>s)}),[i,a,r]),g=[{title:"Full Name",dataIndex:"fullName",key:"fullName"},{title:"Service Number",dataIndex:"serviceNumber",key:"serviceNumber"},{title:"Account Number",dataIndex:"accountNo",key:"accountNo"},{title:"Deduction Amount",dataIndex:"deduction",key:"deduction",render:e=>t.jsx(x,{colorScheme:"blue",children:e})},{title:"Status",dataIndex:"status",key:"status",render:e=>t.jsx(x,{colorScheme:e==="ACTIVE"?"green":"red",children:e})}],S=()=>{window.print()};return u?t.jsx("div",{className:"text-red-500",children:u}):t.jsxs("div",{className:"mt-14",children:[t.jsx("p",{className:"text-3xl font-bold mb-6",children:"Monthly Deductions"}),t.jsxs("div",{className:"flex justify-between",children:[t.jsxs(d,{spacing:4,children:[t.jsxs("button",{style:{background:"green",color:"white",padding:"8px 16px",borderRadius:"5px",border:"none",cursor:"pointer"},onClick:()=>{try{const e=l.map(s=>({"Full Name":s.fullName,"Service Number":s.serviceNumber,"Account Number":s.accountNo,"Deduction Amount":s.deduction,Status:s.status}));if(e.length===0){m({title:"No deduction data found",status:"warning"});return}const o=[{key:"Full Name",header:"Full Name",width:20},{key:"Service Number",header:"Service Number",width:18},{key:"Account Number",header:"Account Number",width:18},{key:"Deduction Amount",header:"Deduction Amount",width:18},{key:"Status",header:"Status",width:15}],c=a&&r?`_${a}_to_${r}`:a?`_from_${a}`:r?`_to_${r}`:"";k({data:e,columns:o,filename:`monthly-deductions${c}_${new Date().toISOString().slice(0,10)}.xlsx`,sheetName:"Monthly Deductions",title:`Monthly Deductions Report${c?` (${c.replace(/_/g," ")})`:""}`}),console.log(`Successfully exported ${e.length} deduction records`)}catch(e){console.error("Export failed:",e),m({title:"Export failed",status:"error"})}},children:["Export Excel (",l.length,")"]}),t.jsx(w,{onClick:S,colorScheme:"teal",size:"sm",children:"Print Report"})]}),t.jsxs(d,{spacing:4,mb:4,children:[t.jsxs(d,{children:[t.jsx("label",{htmlFor:"startDate",className:"block text-xs font-medium mb-1",children:"From"}),t.jsx(h,{size:"sm",type:"date",id:"startDate",value:a,onChange:e=>D(e.target.value),max:r||void 0})]}),t.jsxs(d,{children:[t.jsx("label",{htmlFor:"endDate",className:"block text-xs font-medium mb-1",children:"To"}),t.jsx(h,{size:"sm",type:"date",id:"endDate",value:r,onChange:e=>y(e.target.value),min:a||void 0})]})]})]}),t.jsx(v,{data:l,columns:g,loading:f,rowKey:"serviceNumber"})]})};export{H as default};
