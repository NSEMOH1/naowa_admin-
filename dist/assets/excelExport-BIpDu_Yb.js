import{u as n,w as y}from"./xlsx-3SA47z_C.js";const _=({data:c,columns:s,filename:l=`export_${new Date().toISOString().split("T")[0]}.xlsx`,sheetName:p="Sheet1",title:i})=>{if(!c||c.length===0){console.warn("No data provided for Excel export");return}const f=c.map(r=>{const a={};return s.forEach(o=>{let e=r[o.key];switch(o.type){case"date":e&&(e=new Date(e).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"}));break;case"currency":typeof e=="number"&&(e=parseFloat(e.toString()));break;case"number":e!=null&&(e=parseFloat(e.toString())||0);break;default:e==null&&(e="N/A")}a[o.header]=e}),a}),d=n.book_new();let t;if(i){const r=[{[s[0].header]:i}],a=[{}],o=[...r,...a,...f];t=n.json_to_sheet(o,{skipHeader:!1});const e=n.encode_range({s:{c:0,r:0},e:{c:s.length-1,r:0}});t["!merges"]=[n.decode_range(e)],t.A1.s={font:{bold:!0,sz:14},alignment:{horizontal:"center"}}}else t=n.json_to_sheet(f);if(t["!cols"]=s.map(r=>({width:r.width||15})),t["!ref"]){const r=n.decode_range(t["!ref"]),a=i?2:0,o=n.encode_range({s:{c:0,r:a},e:{c:s.length-1,r:r.e.r}});t["!autofilter"]={ref:o}}const g=i?3:1;t["!freeze"]={xSplit:0,ySplit:g};const h=n.decode_range(t["!ref"]||"A1"),w=i?2:1;s.forEach((r,a)=>{if(r.type==="currency"||r.type==="number"||r.format)for(let o=w;o<=h.e.r;o++){const e=n.encode_cell({r:o,c:a});t[e]&&typeof t[e].v=="number"&&(r.format?t[e].z=r.format:r.type==="currency"?t[e].z="#,##0.00":r.type==="number"&&(t[e].z="#,##0"))}}),n.book_append_sheet(d,t,p),y(d,l)};export{_ as e};
